#!/usr/bin/env bash

function httpless {
  # `httpless example.org'
  http --pretty=all --print=HBhb "$@" | less -R;
}

function httpperf {
  curl -o /dev/null -s -w "%{time_connect} (time_connect) + %{time_starttransfer} (starttransfer) = %{time_total} (time_total)\n" "$@"
}

function jqbrowser {
  local TMPFILE=$(gmktemp --suffix=".json")
  jq '.' > "${TMPFILE}"
  open -b 'com.google.chrome' "${TMPFILE}"
}

function sscreencapture-in-2-seconds-send-to-desktop {
  screencapture -T2 -S -x "$HOME/Desktop/screenshot-$(date +%Y-%m-%d__%H_%M_%S).png"
}

function postgresstart {
  local pidfile="/usr/local/var/postgres/postmaster.pid"
  if [ -s $pidfile ] && kill -0 $(cat $pidfile | head -n 1) > /dev/null 2>&1; then
    echo "Already running"
  else
    pg_ctl -D /usr/local/var/postgres -l /usr/local/var/postgres/server.log start
  fi
}

function postgresstop {
  pg_ctl -D /usr/local/var/postgres stop
}

function mongoose-http-server {
  local port=${1:-8000}
  local ip=$(ipconfig getifaddr en0)
  echo "Serving on ${ip}:${port} ..."
  python -m SimpleHTTPServer ${port}
}

function zco {
  git checkout $(git branch --verbose | ggrep --invert-match '^*' | sort | fzf --no-sort --reverse --exact --query="${@:-}" | gawk '{print $1}');
}
